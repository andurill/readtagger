sudo: false
os:
- linux
language: python
python:
- '2.7'
- '3.5'
env:
  global:
    - secure: "kCYuKyRRl0CIML6XVbsKQ05DJwR02CqOfehUJ0mVolMiry5k7w4Zh4YBAdmGIRbokcT3qKCgd3HvqvlYTGVvwxJQF1d2+G1KQNU4+M+BBR/NMTO1ij+uARXeRHoG6DPSr+6KFqdq/Ehchtt3rQNOxwJodhKW9q70caU5HvrLLs3EMuiRnmJFpP0eg5dR7pLpc5XS6Sy3K7idE3i/rXyF1Q/NlJb1+qkTPm4CYeaObPb4tkEDi4tNl/e74i/R2MEPtvCWdBJbwlcazPTbUC0GJEn4XnRh/zi5z+u9gVC6UhXZWeWzY3ypIqfx20igOfvL2yllHPF0ohDVC1q0GpoO8Y5jP1lvx+GkcCLHEP4XS6VykRW4AFTJOA/vo/xthU8HMa5/pH4iRvN5FZvwW6GUKZ8mIqS5elJepPB89Eg9oTbRdr3VSckaP4orTqr/uSb5StoTq7pJWjxFc4La+BHTQUsGt8V6RFVvKaHebkHjyLA479IyDuytKvAZMxrD1djm6nqyMFymruj4/WWMXPdv2RDUZ/DlECO/cVF/ETmtIFLaSXp0boWng5/fa4a9euaikvySFfZoS99Nq5r7pmwTuxcfuGwcK5W1mYCTICCvihD4pcUV8uc2sxmsp5V0wjcoYUmC1HJ/0XFZePm+IhqQZj+YgA2p/GVHIEvkIXGhIM8="
    - secure: "Ypcq7vc0e8/fDFSZ4ldlVEWVUCk65NrLi4xUFeVDjFbUsuGJ+9cO9DPk7fgAx5uSQy0b7LLZ+4iY/1dHzcvTmg1HauH8AIBgqyR2bi2yASiwkWF5path/yZ2tpgUHQnPYURVwo2OcQAxPIn7u5+lyjikOU7PHN7vqkBaXEAwTBC26ALPdROmrGaNAUaSz/JXYw6cFnHe/5UGWrIfCFIsa/W+MbOlz9X7gAGRAtReCqWSLqibuGatNVF3z815PqzjYLtTtDqDr9HIjFuDjqLcfW6Yp/fO6qf7A2ePXEldNrl1etYVtwZCQpGkzvQTFv91SN28yRMukRSBeoETmVzyr+uza3Fu+3OhP3LmLe/ArzrJxl7cmDlNW8MyaCLovK5f1LJ0QGh4h+OSw2lKMMFR1FOnWE/ziziYpm0YQZ2vxdNPQM/UsgOF+86z2bilEn1WRhML8AI+I0thCegVz/BbTEtIQ8Ejl3IZlwopdQt8BNVPhSJA2NIVVn887skoxLOy/zHc1XwGVt9Rl80+SWhfhVmnFNhYOTYV5cw8uI1kM5JoLYo/iTb+H9Hbf2NjuqfqMHoKHvCwcuz+pTQfO7b+cbNHQ5X3kIbKrPuiGv948et/W6Zwr83TbyS1fgWUou2ng3REpgez5dpB5ilqCxz4wEPFfW+gM2SFlBiaPI1p0gw="
    - secure: "qxLuCub1LQrQoDiENiPDW69Bb/usB0mVWx7s+6tEk6C/uyhvykBA+O7ygtnC+tBJyWhW75grtMRrQFr00U/7MkfoCqSOTbA7Kupv1QL0GNmYu+/TR50wVeXcegViCJE4okQTNEJ7p4XQC9FVM1Ke2W4UY2ZisBJ07weS6BhQnGaXXXiRotQ8gfpj1YyKodyg8zDiHzkV8RYYidAZLOvR68hMaTiArGXmAd1i+7GdWWiGeOwRWnXOSWnUMj6J19ImJTSGXeR3BmyFdzDd+V9JL2/bp3Q2okBGUi7uGqbZHgYZgg1dznw5/KFzU3E7P63aQXNJmpQf04TzFCA7HGler/n3wrCViyY9o6Dfh7w3aYF9hU47R0TTXqDXFtZkwNHqyXNB3GW2wGTQ7tjxq2NaC4Gtq6pYEtondpn/vGep3pYL/Gyb6udrF+79a0gn2ZWCnvgbZyCZ3bW6v5N2xdGPEWG/O699A98PFGt0dAyrtTv5yI7HxZnuef33wZY7zEaKTyRQW+CsaeF7peWCSNn17JgcLE2TouXkZypQ9jb53nttqueJNnitWw3YGgMXWUG6aXmjZ+mFsXMvhrZFRyBvWfS4C5+tCZWQbKV6bT3UpY4rWqJUVpJTDvGKfrGqhk6WGrvk+I8f5cezArc9iZ4LjIbVelz6wQQgma6uIBr33ak="
    - secure: "T1QVriEiMZFIs1YNRihRlNvww94f/Q6eBLwYBaRgY0E7af2Mj+Xw7000mg34/UASyFjsgPrXW+JKjlPaNp7AfR3gyYm0wLJSNRBayPMchlNOb5dvrQbAd3hdoiKuXy3tAEHvpd4CGh2oxfx2CpLJqGyMN3Jvu3wFdnu7wSS5GDqTtvVxVipEle4ZeFu3tF8eCFSfVivqtIomwTM1Jw2MMEUtKOKZdPOM/GivQzbcVNqdpIKTHOvte8dRn0prQ7/UzbCAVatcu+lPWtEbLbBfYz7kX+gpE9BTY+a2z6CswkUaZaOCoaK34dif2KRDjL8a1zMXndpBW3oB2gO2ErS22uWONzo831f9Y7JxSy+S2BxFVPsULztCPmfIfMXTEc42huzHUjxh0VGfaUuePR56kJjJeYFacRjw1opQvHDcSjRfeOXTSB+QyghJRPVCVsMjEoLtokjldokWKyjfCLU5DgQNKwR6LiPK1CU+kvL1K9aLqt98Sd5odH0OdYcnYMo2UTWnAiHnRpuramAHkfRP+22Pqax8z8AyiISvOQY1t/Q2sR5DxrrRUDjDKJDZMNtbdh1SQ8k0A0AhklaexDbTVrE1BxhMfa6Xn3s1qrC4IEWXISOHMgQFEP+20BW0rSdgaQzusaNt+WroJfGuvvuX4fgKNe7RNJqmpI9gKB7mkik="
    - CONDA_PREFIX=~/conda
    - CONDA_BIN=~/conda/bin/conda
install:
  - if [[ "$TRAVIS_PYTHON_VERSION" == "2.7" ]]; then
      wget http://repo.continuum.io/miniconda/Miniconda-latest-Linux-x86_64.sh -O miniconda.sh;
    else
      wget http://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh;
    fi
  - bash miniconda.sh -bp $CONDA_PREFIX
  - export PATH="$CONDA_PREFIX/bin:$PATH"
  - $CONDA_BIN config --set always_yes yes --set changeps1 no
  - $CONDA_BIN --version
  - $CONDA_BIN config --add channels mvdbeek
  - $CONDA_BIN config --add channels bioconda
  - $CONDA_BIN config --add channels conda-forge
  - $CONDA_BIN install blast bwa cap3 sambamba samtools virtualenv conda-build -c bioconda
  - samtools --version
  - pip install tox-travis coveralls anaconda-client
  - mkdir -p ~/.planemo/ && virtualenv ~/.planemo/gx_venv
  - $CONDA_BIN build --python "$TRAVIS_PYTHON_VERSION" conda/readtagger
script: tox
after_success:
    - chmod +x conda/deploy.sh galaxy/deploy.sh
    - coveralls
deploy:
  - provider: pypi
    skip_cleanup: true
    user: mvdbeek
    password:
      secure: t3Icum4IahHP8eF+e8OEy2d0/Vb+AUd8GWuYM/SoG/Fqf2OBKiyS2fJGfL5N96k4JGzxfIMoV5vNJ/WPiNA3wPluYb8KW6ork2Mp/0UuxHTCkkdmjeGE528qWkprS8F+0N4qDDdK+6k+hOmGdSiiRryCzIz2deAb07npNytnlqbe70CGskTwrBAdxjFmkvjxMje0QSxdFIBNksBt4qd3x1UjMJ14BtYFPSgAXE0HYwEzrFyMLIXoA3kevCKpXYsX8bT7uPpNNKDvyG6hTyKraUPAXv/eX3JfFFu9vURzJQik5UQ+0S1Wc1hyevc9nZkTyIEpPOqmoZvBU0lI/wNGlw0c72VDwLxvJyspq/5HTsQaHih4KJX7jFHjVRbIT/Fu8KKp7gQyAAtEwgj+6SeE++EFDGSlrjqST3lHWjAZE07ODuCH/DS4oSFajrnqu7a481D03cm14FFGr6M6joxbPpylOPSqjJkVvndt06+68zdXtKg8UOHLNmUyLudZez5oEr277MQYtAZkDEVXn8mpysxeh7DdlenLQdQaW3rA65GuIe5F4nGRYX5xYwedXCQEZNWv1LqjMb1zDvlkRQ3l8e1fn8Swrdj+/Z2mZB4kq3tSS3mHL3H9euFHRbzRuE/fRLu1rkyTJH5K99Y5HrjT8C1n75md/BS3lSVggB7zcyc=
    on:
      tags: true
      python: 2.7
  - provider: script
    skip_cleanup: true
    script: conda/deploy.sh
    on:
      tags: true
      python: 2.7
  - provider: script
    skip_cleanup: true
    script: galaxy/deploy.sh
    on:
      tags: true
      python: 2.7
